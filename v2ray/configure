#!/usr/bin/env sh

if [ -z "$1" ]; then
  echo
  echo "Usage: ./configure <host> <UUID>, the <UUID> is optional"
  echo
  exit 1
fi

uuid="$2"
if [ -z "$uuid" ]; then
  uuid=$(uuidgen)
fi

host=$1
echo "Connection ID: " ${uuid}
echo "Connection Host: " ${host}

mkdir -p build
cd ./template/
for file in $(find *.example); do
    echo ${file} ./build/${file%.example}
    sed "s/\[UUID\]/${uuid}/g; s/\[HOST\]/${host}/g" ${file} > ../build/${file%.example}
done

echo "in ./build docker-compose up -d"